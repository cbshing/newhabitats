##########################################################################
# Decisions
##########################################################################

# Establish Trade District Habitat
decision_trade_district_habitat = {
	owned_planets_only = yes
	
	prerequisites = {
		""		
	}

	resources = {
		category = decisions
		cost = {
			minerals = 450
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		owner = { 
			is_regular_empire = yes 
		}
		NOT = { 
			has_planet_flag = trade_habitat
		}
	}
	
	allow = {
		planet_size >= 2
		free_district_slots > 0
	}
	
	effect = {
		add_district = district_hab_commercial 	
		hidden_effect = { set_planet_flag = trade_habitat }
	}
	
	ai_weight = {
		weight = 1

		modifier = {
			factor = 5
			free_amenities < 2
		}
		modifier = {
			factor = 0
			OR = {
				has_planet_flag = cultural_habitat
				has_planet_flag = research_habitat
			}
		}
	}
}

decision_remove_trade_district_habitat = {
	owned_planets_only = yes
	icon = decision_trade_district_habitat

	resources = {
		category = decisions
		cost = {
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		has_planet_flag = trade_habitat
	}
	
	allow = {
		custom_tooltip = {
			fail_text = decision_remove_trade_habitat_requirements
			num_districts = { type = district_hab_commercial value < 1 }
		}
	}
	
	effect = {
		hidden_effect = { remove_planet_flag = trade_habitat }
	}
	
	ai_weight = {
		weight = 0
	}
}

# Establish Leisure District Habitat
decision_cultural_district_habitat = {
	owned_planets_only = yes
	
	prerequisites = {
		""		
	}

	resources = {
		category = decisions
		cost = {
			minerals = 450
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		owner = { 
			is_regular_empire = yes 
		}
		NOT = { 
			has_planet_flag = cultural_habitat
		}
	}
	
	allow = {
		planet_size >= 2
		free_district_slots > 0
	}
	
	effect = {
		add_district = district_hab_cultural 	
		hidden_effect = { set_planet_flag = cultural_habitat }
	}
	
	ai_weight = {
		weight = 1

		modifier = {
			factor = 3
			free_amenities < 2
		}
		
		modifier = {
			factor = 0
			OR = {
				has_planet_flag = generator_habitat
				has_planet_flag = foundry_habitat
			}
		}
	}
}

decision_remove_cultural_district_habitat = {
	owned_planets_only = yes
	icon = decision_cultural_district_habitat

	resources = {
		category = decisions
		cost = {
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		has_planet_flag = cultural_habitat
	}
	
	allow = {
		custom_tooltip = {
			fail_text = decision_remove_leisure_habitat_requirements
			num_districts = { type = district_hab_cultural value < 1 }
		}
	}
	
	effect = {
		hidden_effect = { remove_planet_flag = cultural_habitat }
	}
	
	ai_weight = {
		weight = 0
	}
}

# Establish Research District Habitat
decision_research_district_habitat = {
	owned_planets_only = yes
	
	prerequisites = {
		""		
	}

	resources = {
		category = decisions
		cost = {
			minerals = 450
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		NOT = { 
			has_planet_flag = research_habitat
		}
	}
	
	allow = {
		planet_size >= 2
		free_district_slots > 0
	}
	
	effect = {
		add_district = district_hab_science 	
		hidden_effect = { set_planet_flag = research_habitat }
	}
	
	ai_weight = {
		weight = 1
		modifier = {
			factor = 0
			OR = {
				has_planet_flag = generator_habitat
				has_planet_flag = foundry_habitat
			}
		}
	}
}

decision_remove_research_district_habitat = {
	owned_planets_only = yes
	icon = decision_research_district_habitat

	resources = {
		category = decisions
		cost = {
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		has_planet_flag = research_habitat
	}
	
	allow = {
		custom_tooltip = {
			fail_text = decision_remove_science_habitat_requirements
			num_districts = { type = district_hab_science value < 1 }
		}
	}
	
	effect = {
		hidden_effect = { remove_planet_flag = research_habitat }
	}
	
	ai_weight = {
		weight = 0
	}
}

# Establish Generator District Habitat
decision_energy_district_habitat = {
	owned_planets_only = yes
	
	prerequisites = {
		""		
	}

	resources = {
		category = decisions
		cost = {
			minerals = 450
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		NOT = { 
			has_planet_flag = generator_habitat
		}
	}
	
	allow = {
		planet_size >= 2
		free_district_slots > 0
		solar_system = {
			custom_tooltip = {
				fail_text = "requires_no_black_hole_or_dyson_sphere"
				NOR = {
					is_star_class = sc_black_hole
					has_megastructure = dyson_sphere_3
					has_megastructure = dyson_sphere_4
					has_megastructure = dyson_sphere_5
				}
			}				
		}
	}
	
	effect = {
		add_district = district_hab_energy 	
		hidden_effect = { set_planet_flag = generator_habitat }
	}
	
	ai_weight = {
		weight = 1
		modifier = {
			factor = 3
			owner = { 
				has_monthly_income = {
					resource = energy
					value < 8
				}
			}
		}

		modifier = {
			factor = 2
			free_housing < 0
		}

		modifier = {
			factor = 3
			any_owned_pop = { 
				OR = { 
					is_unemployed = yes 
					has_job = servant 
				}
			}
		}

		# No one to work it anyway
		modifier = {
			factor = 0
			free_housing > 0
			NOT = {
				any_owned_pop = { 
					OR = { 
						is_unemployed = yes 
						has_job = servant 
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				has_planet_flag = trade_habitat
				has_planet_flag = cultural_habitat
				has_planet_flag = research_habitat
			}
		}
	}
}

decision_remove_energy_district_habitat = {
	owned_planets_only = yes
	icon = decision_energy_district_habitat

	resources = {
		category = decisions
		cost = {
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		has_planet_flag = generator_habitat
	}
	
	allow = {
		custom_tooltip = {
			fail_text = decision_remove_energy_habitat_requirements
			num_districts = { type = district_hab_energy value < 1 }
		}
	}
	
	effect = {
		hidden_effect = { remove_planet_flag = generator_habitat }
	}
	
	ai_weight = {
		weight = 0
	}
}

# Establish Foundry District Habitat
decision_foundry_district_habitat = {
	owned_planets_only = yes
	
	prerequisites = {
		""		
	}

	resources = {
		category = decisions
		cost = {
			minerals = 450
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		NOT = { 
			has_planet_flag = foundry_habitat
		}
	}
	
	allow = {
		planet_size >= 2
		free_district_slots > 0
	}
	
	effect = {
		add_district = district_hab_foundry 	
		hidden_effect = { set_planet_flag = foundry_habitat }
	}
	
	ai_weight = {
		weight = 1
		modifier = 	{
			factor = 4
			owner = { 
				has_monthly_income = {
					resource = alloys
					value < 12
				}
			}
		}
		modifier = {
			factor = 0
			OR = {
				has_planet_flag = trade_habitat
				has_planet_flag = cultural_habitat
				has_planet_flag = research_habitat
			}
		}
	}
}

decision_remove_foundry_district_habitat = {
	owned_planets_only = yes
	icon = decision_foundry_district_habitat

	resources = {
		category = decisions
		cost = {
			influence = 50
		}
	}
	
	potential = {
		is_planet_class = pc_habitat
		has_planet_flag = foundry_habitat
	}
	
	allow = {
		custom_tooltip = {
			fail_text = decision_remove_foundry_habitat_requirements
			num_districts = { type = district_hab_foundry value < 1 }
		}
	}
	
	effect = {
		hidden_effect = { remove_planet_flag = foundry_habitat }
	}
	
	ai_weight = {
		weight = 0
	}
}
